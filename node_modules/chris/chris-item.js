

   
import { PolymerElement, html } from 'https://dashboard.dazzle.website/node_modules/@polymer/polymer/polymer-element.js';
import {Dazzle} from 'https://dashboard.dazzle.website/node_modules/@dazzle/dz-dazzle/dz-library.js';

class greenPageLoader extends PolymerElement {
    static get is(){
        return 'chris-item';
    }
    // static get properties() {
    //       return {

    //       }
    //     }

    constructor(){
        super();
        this.productManager = new DataPackage('product');

    }
    connectedCallback() {
      super.connectedCallback();
      this.itemId = this.getAttribute('item-id') || null;
        //   this.template = document.querySelector('template#chris-item').innerHTML;
        this.template = this.innerHTML;
        this.productManager.getDataByES(this.itemId).then(res=>{
            this.innerHTML = this.productManager.replaceToken(res,this.template); 
        });    
    }
    
    digestForm(){
        let inputs=document.querySelectorAll('input, select');
        let json = {};
        inputs.forEach(item=>{
           let field = item.getAttribute('name') || null;
           json[field] = item.value;
           console.log('Digest item',item,item.value);

        });
        console.log('Digest',json);
        return json;
    }
    _addCart(e){
        console.log('add cart');
        
    }
    _listener(){
        console.log("user component loaded");
        let buttons = document.querySelectorAll('[dz-func]');
        buttons.forEach(item=>{
            let fc = item.getAttribute('dz-func') || null;
            item.addEventListener('click',e=>{
                switch(fc){
                    case '_select':
                        this._select(e);
                    break;
                    
                    case '_addCart':
                        this._addCart(e);
                        
                    break;

                // ....    
                }
  
            });            
        });
        
    }
    ready(){
        super.ready();
       

     }
    _select(e) {
        let target = e.currentTarget;
        let id = target.getAttribute('item-id') || null;
        store.set('my-product',id);
        location.href="/productpage.html";
    }

    static get template () {
        return html`
            <slot></slot>
        `;
      }
}
customElements.define(greenPageLoader.is, greenPageLoader);
   